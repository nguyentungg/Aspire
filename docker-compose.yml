version: "3.9"
services:
  caddy:
    image: caddy:2.3.0-alpine
    container_name: caddy
    ports:
      - 80:80
      - 443:443
    volumes:
      - ./.docker/caddy/Caddyfile:/etc/caddy/Caddyfile
      - ./frontend:/home/frontend
    depends_on:
      - frontend
#      - backend
    networks:
      - aspire

#  backend:
#    container_name: backend
#    build:
#      context: .
#      dockerfile: ./.docker/flask/Dockerfile
#    ports:
#      - 5000:5000
#    volumes:
#      - ./backend:/home/backend
#      - ./data:/home/backend/data
#    working_dir: /home/backend
#    entrypoint: bash -c 'python ./app.py'
#    networks:
#      - aspire
#    env_file:
#      - ./.env

  frontend:
    container_name: frontend
    build: 
      context: .
      dockerfile: ./.docker/quasar/Dockerfile
    volumes:
      - ./frontend:/home/frontend
    ports:
      - 8080:8080
    working_dir: /home/frontend
    entrypoint: bash -c 'quasar dev'
    networks:
      - aspire

networks:
  aspire:
    name: aspire
    driver: bridge
